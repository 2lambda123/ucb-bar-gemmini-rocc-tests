prefix		:= @prefix@
abs_top_srcdir	:= @abs_top_srcdir@
XLEN            := @XLEN@
RISCVTOOLS      := @RISCVTOOLS@
ROCC = examples

.PHONY: all bareMetal bareMetalC bareMetalCpp clean pk mobilenet systolic_library resnet
all: bareMetal bareMetalC bareMetalCpp pk mobilenet systolic_library resnet

vars = \
	abs_top_srcdir=$(abs_top_srcdir) \
	XLEN=$(XLEN) \
	PREFIX=$(ROCC)-$@ \
	src_dir=$(abs_top_srcdir)/$@ \
	RISCVTOOLS=$(RISCVTOOLS)

bareMetal:
	mkdir -p $@
	$(MAKE) -C $@ -f $(abs_top_srcdir)/$@/Makefile $(vars)

bareMetalC:
	mkdir -p $@
	$(MAKE) -C $@ -f $(abs_top_srcdir)/$@/Makefile $(vars)

bareMetalCpp:
	mkdir -p $@
	$(MAKE) -C $@ -f $(abs_top_srcdir)/$@/Makefile $(vars)

pk:
	mkdir -p $@
	$(MAKE) -C $@ -f $(abs_top_srcdir)/$@/Makefile $(vars)

mobilenet:
	mkdir -p $@
	$(MAKE) -C $@ -f $(abs_top_srcdir)/$@/Makefile $(vars)

systolic_library:
	mkdir -p $@
	$(MAKE) -C $@ -f $(abs_top_srcdir)/$@/Makefile $(vars)

resnet:
	mkdir -p $@
	$(MAKE) -C $@ -f $(abs_top_srcdir)/$@/Makefile $(vars)

clean:
	$(MAKE) -C pk -f $(abs_top_srcdir)/pk/Makefile abs_top_srcdir=$(abs_top_srcdir) PREFIX=$(ROCC)-pk clean
	$(MAKE) -C bareMetal -f $(abs_top_srcdir)/bareMetal/Makefile abs_top_srcdir=$(abs_top_srcdir) PREFIX=$(ROCC)-bareMetal clean
	$(MAKE) -C bareMetalC -f $(abs_top_srcdir)/bareMetalC/Makefile abs_top_srcdir=$(abs_top_srcdir) PREFIX=$(ROCC)-bareMetalC clean
	$(MAKE) -C bareMetalCpp -f $(abs_top_srcdir)/bareMetalCpp/Makefile abs_top_srcdir=$(abs_top_srcdir) PREFIX=$(ROCC)-bareMetalCpp clean
	$(MAKE) -C mobilenet -f $(abs_top_srcdir)/mobilenet/Makefile abs_top_srcdir=$(abs_top_srcdir) PREFIX=$(ROCC)-mobilenet clean
	$(MAKE) -C systolic_library -f $(abs_top_srcdir)/systolic_library/Makefile abs_top_srcdir=$(abs_top_srcdir) PREFIX=$(ROCC)-systolic_library clean
	$(MAKE) -C resnet -f $(abs_top_srcdir)/resnet/Makefile abs_top_srcdir=$(abs_top_srcdir) PREFIX=$(ROCC)-resnet clean
